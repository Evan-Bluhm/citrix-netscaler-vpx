---
copyright:
  years: 1994, 2017
lastupdated: "2018-11-12"

keywords: load balancing, vpx, global, mep, gslb

subcollection: citrix-netscaler-vpx
---

{:shortdesc: .shortdesc}
{:new_window: target="_blank"}
{:tip: .tip}
{:note: .note}
{:important: .important}

# 使用 {{site.data.keyword.vpx_full}} 进行全局负载均衡
{: #global-load-balancing-with-citrix-netscaler-vpx}

全局服务器负载均衡 (GSLB) 是一种在多个服务器/实例（通常位于不同的地理位置）之间分布流量的机制。该构想是通过一个全局均衡引擎/服务器接收来自客户机的流量请求，并将其重定向到某个地理位置；地理位置使用管理员选择并配置的条件/算法来确定。要实现此目的，可以在 {{site.data.keyword.BluSoftlayer_notm}} 网络中使用两种公认的方法：

* **CDN：**为了交付内容和富媒体（例如，图像和视频）而发出的内容交付网络 (CDN)，CDN 在地理上分散的节点中分布内容，同时保持最短等待时间和最高速度。在需要分布内容的特定部分（而不是整个 Web 站点/应用程序）时，通常会实现 CDN。{{site.data.keyword.BluSoftlayer_notm}} 提供此服务；请在[此处](/docs/infrastructure/CDN?topic=CDN-getting-started)阅读更多相关信息。
* **NetScaler VPX：**就像常规本地负载均衡一样，VPX 也使用类似的对象层次结构在多个地理位置之间对流量进行负载均衡。NetScaler 通过基于 DNS 的全局查找，选择对应于所选位置/站点的相应记录，所选项基于管理员预配置的条件。入局部分将在此选项/产品上展开。

还有其他技术可用于内容分布（例如 HTTP 重定向），这些技术也可以使用 {{site.data.keyword.vpx_full}} 来实现。
{: note}

## 关于 VPX 上的 GSLB
{: #about-gslb-on-vpx}

可以通过在 CLI/GUI 上激活 NetScaler VPX 的 GSLB 功能来启用该功能。

GSLB 使用的组件/对象与本地负载均衡部署中使用的非常类似，其中实体是使用分层模型定义的。

GSLB 可能出于多种目的来实现。其中一些目的可能包括：

* **负载共享/分布：**用于在多个位置之间高效、智能地分布资源。
* **灾难恢复：**当主位置关闭或无法呈现服务时使用。在此场景中，备用/备份位置可以进行接管。
* **性能/塑形：**这允许您将内容定位在更靠近终端系统的位置，或以增强相关服务的方式来定位内容。

GSLB 过程/部署中的主要组件或实体包括：

* **虚拟服务器：**VIP 是客户机向其发送请求的 IP 地址，NetScaler 会终止 VIP 上的客户机连接，然后启动与（本地）负载均衡服务中所配置的服务器的连接。
* **DNS（域名系统）和名称服务器：**GSLB 上的名称解析的工作方式与常规 DNS 非常类似。区别在于用于确定已解析地址的逻辑/条件，GSLB 使用预配置的负载均衡方法来处理此解析。NetScaler 可以配置为以不同方式与 DNS 进行交互：
	* 权威 DNS (ADNS)。使用 ADNS 方式的 NetScaler 对于特定域及其所有相关记录都具有权威性。
	* DNS 子授权。DNS 服务器（对于域具有权威性）将子域的责任委派给 NetScaler 系统时执行。
	* DNS 代理。在此方式下进行配置时，NetScaler 会将 DNS 请求转发到处理名称解析的其他服务器（外部）。
* **方法：**方法是 GSLB 虚拟服务器用于从拓扑中选择最佳 GSLB 服务的算法。算法用于评估与实际选择标准相对应的性能方面。提供了以下方法：
  * Round Robin：使入局请求在 GSLB 站点/服务之间交替进行处理，而不考虑其负载。
  * Round Trip Time (RTT)：度量客户机的本地 DNS 服务器与 (GSLB) 站点之间的时间或延迟时间。NetScaler 使用不同的机制（例如，ICMP 回传请求/应答 (PING)、UDP 和 TCP）来收集 RTT 度量值。
  * Static Proximity：使用 IP 地址数据库来确定客户机的本地 DNS 服务器与站点之间的邻近性，然后将此作为条件进行选择。
  * Least Connections：度量作为选择条件的每个站点/服务上的最少活动连接数。
  * Least Response Time：选择具有最少活动连接数和最短平均响应时间的站点。
  * Least Bandwidth：选择当前管理最少流量 (Mbps) 的站点。
  * Least Packets：选择最近 14 秒内接收到的包数最少的服务。
  * Source IP address Hash：根据客户机 IPv4 或 IPv6 地址的散列值来选择服务。
  * Custom Load：选择未处理任何活动事务的服务。如果负载均衡设置中的所有服务都在处理活动事务，那么设备会选择负载（CPU 使用率、内存和响应时间）最小的服务。

* **MEP（度量值交换协议）：**一种专用协议，用于交换站点之间的度量值（负载和网络）和持久性信息。MEP 在 GSLB 网络/拓扑中的不同站点/NetScaler 之间提供运行状况检查。通过使用由管理员设置的条件，MEP 为站点提供了一种方法来根据先前配置的选择参数传达和处理流量。MEP 使用 TCP 端口 3009 和 3011。禁用 MEP 时，可选择的方法限制为前面标记有星号 (*) 的选项。选择其他任何方法都会还原为“循环法”。
* **监视：**NetScaler 引擎使用 MEP 或与相关服务绑定的显式监视器，定期对远程 GSLB 服务的状态求值。监视器的使用方式就像常规负载均衡服务一样。对于 GSLB，无需向本地服务添加监视器，因为这通常由 MEP 来控制。
* **持久性：**可选功能，用于确定特定域的站点首选项。在此特定用例中，不会对流量进行负载均衡，而是由同一数据中心对流量进行处理。在交易数据对于每个站点/服务器都唯一的某些应用（如电子商务）中，此功能会非常有用。
* **GSLB 站点：**站点可以定义为在其中配置/提供 NetScaler 系统的数据中心或位置。每个 GSLB 站点由一个被视为该站点“本地”的 NetScaler 系统进行管理，而其他所有远程系统/站点均被视为“远程”站点。
* **GSLB 服务：**这是表示（并绑定到）一个（常规）虚拟服务器/VIP 的对象。这可以是本地（同一站点）或远程对象。
* **GSLB 虚拟服务器：**GSLB 虚拟服务器会分配给一个或多个 GSLB 服务，这些服务通常是不同 (GSLB) 站点的一部分。在其中接收的流量会在与其绑定的站点之间进行负载均衡。根据方法和用例来选择站点。
* **GSLB 域：**表示 GSLB 虚拟服务器负责的域或区域。
* **ADNS 服务：**由 IP 地址和端口的组合表示的服务，在其中将向 NetScaler 具备权威性的域发送 DNS 请求。NetScaler 会将这些请求转至绑定到该域的 GSLB 虚拟服务器，以获取响应。
